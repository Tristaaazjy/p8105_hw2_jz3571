p8105_hw2_jz3571
================
Junyan Zhu

``` r
library(tidyverse)
library(readxl)
```

# Problem 1

``` r
nyc_df = read_csv('./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv') %>% 
  janitor::clean_names() %>% 
  select(line:station_longitude, starts_with("route"), entry, exit_only, vending, entrance_type, ada) %>% 
  mutate(route8 = as.character(route8), route9 = as.character(route9), route10 = as.character(route10), route11 = as.character(route11)) %>% 
  mutate(entry = ifelse(entry == "YES", TRUE, FALSE))
```

    ## Rows: 1868 Columns: 32
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (22): Division, Line, Station Name, Route1, Route2, Route3, Route4, Rout...
    ## dbl  (8): Station Latitude, Station Longitude, Route8, Route9, Route10, Rout...
    ## lgl  (2): ADA, Free Crossover
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

The date has 1868 rows and 20 columns and it contains variables: line,
station_name, station_latitude, station_longitude, route1, route2,
route3, route4, route5, route6, route7, route8, route9, route10,
route11, entry, exit_only, vending, entrance_type, ada. The above date
cleaning steps include selecting required variables, converting route
8-11 into character variables and converting entry variable from
chatacter variable to logic variable. These data are not tidy yet.

-   Number of Distint Stations

``` r
nyc_df %>% 
  select(station_name, line) %>% 
  distinct %>% 
  nrow()
```

    ## [1] 465

There are 465 distinct stations.

-   Number of Ada Compliant Stations

``` r
nyc_df %>% 
  filter(ada == 'TRUE') %>% 
  select(station_name, line) %>% 
  distinct %>% 
  nrow()
```

    ## [1] 84

There are 84 stations are ADA compliant

-   Number of stations without vending alowing entrance

``` r
nyc_df %>% 
  filter(vending == 'NO') %>% 
  pull(entry) %>% 
  mean()
```

    ## [1] 0.3770492

There are 37.7% of the entrances/exits without vending allow entrance.

-   Make Route Number Distinct Variable

``` r
nyc_df %>% 
  pivot_longer(
    route1:route11,
    names_to = "route_number",
    values_to = "route"
  ) %>% 
  filter(route == "A") %>% 
  distinct(station_name, line) %>% 
  nrow()
```

    ## [1] 60

``` r
nyc_df %>% 
  pivot_longer(
    route1:route11,
    names_to = "route_number",
    values_to = "route"
  ) %>% 
  filter(route == "A", ada == "TRUE") %>% 
  distinct(station_name, line) %>% 
  nrow()
```

    ## [1] 17

There are 60 distinct stations serve the A train, of which 17 are ada
compliant

# Problem 2

1)  Clean MR.Trash Wheel Data

``` r
mr_df = read_excel("./data/Trash_Wheel_Collection_Data.xlsx", sheet = "Mr. Trash Wheel", range = "A2:N549") %>% 
  janitor::clean_names()
```

``` r
tidy_mr_df = mr_df %>% 
  mutate(sports_balls = as.integer(sports_balls)) %>%
  mutate(vessel_type = "Mr.Trash Wheel") %>%
  mutate(dumpster = as.integer(dumpster))%>%
  drop_na(dumpster)
```

2)  Clean Professor Trash Wheel Data

``` r
pr_df = read_excel("./data/Trash_Wheel_Collection_Data.xlsx", sheet = "Professor Trash Wheel", range = "A2:M96") %>% 
  janitor::clean_names()
```

``` r
tidy_pr_df = pr_df %>% 
  filter(!is.na(dumpster)) %>% 
  mutate(vessel_type = "Professor Trash Wheel") %>% 
  mutate(year = as.character(year))
```

3)  Bind Two Together

``` r
bind_df = bind_rows(tidy_mr_df, tidy_pr_df)
```

After combining two datasets, we have 641 rows and 15 columns.
`vessel_type` is an added variable to distinguish the two different
wheels used. Other key variables include dumspter number, month, year,
date, weighted trash in tons, amount of different trash, and homes
powered by trash-generated electricity.

-   Total weigh of trash collected to Professor Trash Wheel

``` r
bind_df %>% 
  filter(vessel_type == "Professor Trash Wheel") %>% 
  select(weight_tons) %>% 
  sum()
```

    ## [1] 190.12

-   Total number of sports balls collected by Mr. Trash Wheel

``` r
bind_df %>% 
  filter(vessel_type == "Mr.Trash Wheel") %>% 
  select(sports_balls) %>% 
  sum()
```

    ## [1] 6869

# Problem 3

1)  Clean plol_month data

``` r
pols_month = read_csv('./data/pols_month.csv') %>% 
  janitor::clean_names()
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
tidy_month = pols_month %>% 
  separate(mon, into = c('year', 'month', 'date'), sep = '-') %>% 
  mutate(month = month.name[as.numeric(month)], year= as.integer(year)) %>% 
  mutate(president = ifelse(prez_gop >= 1, "Republican", 'Democract')) %>% 
  select(-prez_gop, -prez_dem, -date)
```

2)  Clean snp data

``` r
snp_df = read_csv('./data/snp.csv') %>% 
  janitor::clean_names()
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
tidy_snp = snp_df %>% 
  separate(date, into = c('month','date','year'), sep = '/') %>% 
  mutate(month = as.integer(month), date = as.integer(date), year = as.integer(year)) %>% 
  mutate(year = ifelse(year <= 15, year+2000, year+1900)) %>% 
  arrange(year, month) %>% 
  select(year, month, close)
```

3)  Clean unemployment data

``` r
unemp_df = read_csv('./data/unemployment.csv') %>% 
  janitor::clean_names()
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
tidy_unemp = unemp_df %>% 
  pivot_longer(2:13,
               names_to = "month",
               values_to = "unemployment_rate") %>% 
  mutate(month = recode(month,
                        'jan' = 'January',
                        'feb' = 'February', 
                        'mar' = 'March', 
                        'apr' = 'April', 
                        'may' = 'May', 
                        'jun' = 'June', 
                        'jul' = 'July', 
                        'aug' = 'August', 
                        'sep' = "September", 
                        'oct' = 'October', 
                        'nov' = 'November', 
                        'dec' = 'December'), 
         year = as.integer(year))
```
